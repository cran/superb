<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Plotting Reference Intervals with superb</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Plotting Reference Intervals with
<code>superb</code></h1>



<p>In this vignette, we show how to illustrate reference intervals using
<code>superb</code>. We also show how the precision of this interval
limits could be illustrated. See <span class="citation">NCCLS
(2000)</span> for a definition of reference intervals. In what follows,
we use the package <code>referenceIntervals</code> from <span class="citation">Finnegan (2020)</span>.</p>
<div id="what-is-a-reference-interval" class="section level2">
<h2>What is a reference interval?</h2>
<p>The reference interval is a description of the whole population. This
is in contrast with other error bar functions who are associated with a
specific statistics. For example, there exists the standard error of the
mean, or the confidence interval of the median. The reference interval
on the other hand, is an interval of all the individuals in the sample,
and it aims at illustrating the normal range of individuals in the
studied population. It is therefore much wider than say, the confidence
interval of the mean because the mean is not interested with the whole
sample, only with the center of the sample.</p>
<p>As an example, in a pharmacological cross-over study, five drug
concentrations A through E are tested for their effect on glucose level
(in mg/dL). The authors might be interested in knowing whether the
glucose levels are different. In that case, a confidence interval for
the five mean glucose level might be useful.</p>
<p>However, the research may also want to indentify the “normal range”
of values of glucose levels with either of the concentrations. Note tha
“normal range” is a misnomer creating confusions with the “normal
distribution”. Instead, we stick to the expression
<code>Reference interval</code> (as promoted by many, e.g., <span class="citation">NCCLS (2000)</span>).</p>
<p>This interval is meant to capture a given fraction of the population
individuals. These individuals are variable, but this variability is ok
(I don’t want to say <em>normal</em>). This range could be “associated
with good health” for example <span class="citation">(NCCLS, 2000, p.
3)</span>.</p>
<p>Herein, we show how to illustrate <code>reference intervals</code>.
To make the relation with the individuals more evident, we will also
present these intervals in conjunction with alternative
representations.</p>
</div>
<div id="displaying-a-reference-interval" class="section level2">
<h2>Displaying a reference interval</h2>
<p>To accomplish the basic computations, we rely on the excellent
<code>referenceIntervals</code> from <span class="citation">Finnegan
(2020)</span>. This package offers many more options that will not be
explored herein.</p>
<p>Before we begin, let’s load the needed libraries…</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)            <span class="co"># for the graphing commands</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(superb)             <span class="co"># for superbPlot and GRD</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(referenceIntervals) <span class="co"># for computing reference intervals</span></span></code></pre></div>
<p>(if some of these packages are not on your computer, first install it
with for example <code>install.packages(&quot;referenceIntervals&quot;)</code>
)</p>
<p>… then let’s create a ficticious data set on the fly:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>glucoselevels <span class="ot">&lt;-</span> <span class="fu">GRD</span>(<span class="at">BSFactors =</span> <span class="st">&quot;concentration(A,B,C,D,E)&quot;</span>, </span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>                    <span class="at">SubjectsPerGroup =</span> <span class="dv">100</span>,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>                    <span class="at">RenameDV =</span> <span class="st">&quot;gl&quot;</span>,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>                    <span class="at">Effects =</span> <span class="fu">list</span>(<span class="st">&quot;concentration&quot;</span> <span class="ot">=</span> <span class="fu">extent</span>(<span class="dv">10</span>) ),</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>                    <span class="at">Population =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">100</span>, <span class="at">stddev =</span> <span class="dv">20</span>) ) </span></code></pre></div>
<p>This dataset will generate 100 individuals randomly for each of the
five concentrations (column <code>concentration</code>, with levels from
A to E). The dependent variable, <em>glucose level</em>, is abbreviated
to <code>gl</code>.</p>
<p>Here is a snapshot of it:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">head</span>(glucoselevels)</span></code></pre></div>
<pre><code>##   id concentration        gl
## 1  1             A  74.60349
## 2  2             A 117.21601
## 3  3             A 113.37615
## 4  4             A  86.54270
## 5  5             A  99.54379
## 6  6             A  69.35493</code></pre>
<p>A simple plot could show the mean for each concentration along with
the 95% confidence interval of the means, with e.g.,</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">superbPlot</span>(glucoselevels, </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>            <span class="at">BSFactors =</span> <span class="st">&quot;concentration&quot;</span>,  </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>            <span class="at">variables =</span> <span class="st">&quot;gl&quot;</span>, </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>            <span class="at">statistic =</span> <span class="st">&quot;mean&quot;</span>, </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>            <span class="at">errorbar  =</span> <span class="st">&quot;CI&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>            <span class="at">gamma     =</span> <span class="fl">0.95</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>            <span class="at">plotStyle =</span> <span class="st">&quot;line&quot;</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Figure 1. Mean glucose level as a function of concentration." />
<div class="figcaption"><strong>Figure 1</strong>. Mean glucose level as
a function of concentration.</div>
</div>
<p>As seen, glucose level means are affected by the concentration (that
effect was requested in the <code>GRD()</code> command above). Also note
the vertical scale: it is very restricted around the means, yet,
individuals are often much outside the visible part of the scale.</p>
<p>To convince yourself of that, ask for the smallest glucose level and
the highest:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">min</span>(glucoselevels<span class="sc">$</span>gl)</span></code></pre></div>
<pre><code>## [1] 42.93103</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">max</span>(glucoselevels<span class="sc">$</span>gl)</span></code></pre></div>
<pre><code>## [1] 166.3317</code></pre>
<p>Instead of asking for an error bar representing a confidence interval
(CI), let’s ask for error bar representing the reference intervals
(RI).</p>
<p>Reference intervals are not (at this time) shipped with
<code>superb</code>. Let’s define a short-name version of this with</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>RI.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">gamma =</span> <span class="fl">0.95</span>) {</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    <span class="fu">refLimit</span>(data, <span class="at">refConf =</span> gamma)<span class="sc">$</span>Ref_Int</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>}</span></code></pre></div>
<p>We actually use the function <code>refLimit()</code> from the
<code>referenceIntervals</code> package. There are many options in that
function; please consult the documentation for that package. We only
preserve the reference interval limits with <code>$Ref_Int</code> (that
function outputs other information, as we will see below).</p>
<p>The one argument that we use is the confidence level of the reference
interval, <code>refConf</code> (recommended is 95%, which is the default
if none is specified).</p>
<p>As you may note, the <code>RI</code> function is <em>attached</em> to
the mean. This is arbitrary: in <code>superb</code>, error bars must be
error bars of a summary statistic. You could have used any function,
that won’t change the position of the interval.</p>
<p>This is all we need to make our first reference interval plots:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">superbPlot</span>(glucoselevels, </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>            <span class="at">BSFactors =</span> <span class="st">&quot;concentration&quot;</span>,  </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>            <span class="at">variables =</span> <span class="st">&quot;gl&quot;</span>, </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>            <span class="at">statistic =</span> <span class="st">&quot;mean&quot;</span>, <span class="co"># mean is what RI is attached to</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>            <span class="at">errorbar  =</span> <span class="st">&quot;RI&quot;</span>,   <span class="co"># RI calls the function above</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>            <span class="at">gamma     =</span> <span class="fl">0.95</span>,   <span class="co"># select the coverage desired</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>            <span class="at">plotStyle =</span> <span class="st">&quot;line&quot;</span> )</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Figure 2. Mean glucose level and 95% reference intervals as a function of concentration." />
<div class="figcaption"><strong>Figure 2</strong>. Mean glucose level
and 95% reference intervals as a function of concentration.</div>
</div>
<p>You can see that the vertical range is much wider now than in Figure
1. It is ok, as these intervals cover most of the individuals in the
samples.</p>
</div>
<div id="uncertainty-in-the-reference-interval-limits" class="section level2">
<h2>Uncertainty in the reference interval limits</h2>
<p>The plot from Figure 2 shows the estimated range of individuals from
a sample, and therefore has some uncertainty in the exact location of
the tips. It is possible to add some indication of the width of
uncertainty regarding these tips by estimating a confidence interval for
each extremity.</p>
<p>The exact computation is based on the uncertainty of quantiles [e.g.,
the 2.5% quantile for the lower limit of the population as infered from
the 2.5% quantile of the sample, when 95% RI are plotted; see e.g.,
<span class="citation">NCCLS (2000)</span>; <span class="citation">Harding, Tremblay, &amp; Cousineau (2014)</span>].</p>
<p>In the packge <code>referenceIntervals</code>, the function
<code>refLimit()</code> also produces this information by default. The
novelty is that the confidence level of the confidence interval for the
tips of the RI may be different from the reference interval level.</p>
<p>As an example, the RI coverage interval might be a 95%, so as to
include a wide proportion of the population, and the certainty on the
tip positions of that RI might be low, e.g., 80%, because we fear that
the sample is not the most representative.</p>
<p>To acheive this, we wrap the <code>refLimit()</code> function in a
shorter name function, <code>ciloRI</code> for the confidence intervals
of the lower part of the RI, and <code>cihiRI</code> for the confidence
intervals of the upper part of the RI. This function requires two
gammas, one for the RI level, and the second for the CI level. Thus, we
get:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>ciloRI.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">gamma =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.90</span>) ) {</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>    <span class="fu">refLimit</span>(data, <span class="at">refConf =</span> gamma[<span class="dv">1</span>], <span class="at">limitConf =</span> gamma[<span class="dv">2</span>] )<span class="sc">$</span>Conf_Int[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>}</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>cihiRI.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">gamma =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.90</span>) ) {</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    <span class="fu">refLimit</span>(data, <span class="at">refConf =</span> gamma[<span class="dv">1</span>], <span class="at">limitConf =</span> gamma[<span class="dv">2</span>] )<span class="sc">$</span>Conf_Int[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>}</span></code></pre></div>
<p>Again, this is all we need. We can for example use the following to
see the uncertainty in the top tips of all the RI:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">superbPlot</span>(glucoselevels, </span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>            <span class="at">BSFactors =</span> <span class="st">&quot;concentration&quot;</span>,  </span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>            <span class="at">variables =</span> <span class="st">&quot;gl&quot;</span>, </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>            <span class="at">statistic =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">errorbar =</span> <span class="st">&quot;cihiRI&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>            <span class="at">gamma     =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.90</span>),</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>            <span class="at">plotStyle =</span> <span class="st">&quot;line&quot;</span> ) </span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Figure 3. Mean glucose level and 90% confidence intervals of the upper RI tips." />
<div class="figcaption"><strong>Figure 3</strong>. Mean glucose level
and 90% confidence intervals of the upper RI tips.</div>
</div>
<p>Well, that is weird because now, we only see an error bar way up
there. The RI error bar is no longer visible because
<code>superbPlot()</code> can only show one sort of error bar at a
time.</p>
<p>Lets correct this. The gist of the following is to perform three
plots, one showing the RI intervals (as Figure 2 above), a second
showing the confidence interval of the RI top tips (as Figure 3 just
above), and one last plot showing the confidence interval of the RI
bottom tips. Plots 2 and 3 must be transparent so that they can be
superimposed on top of plot 1.</p>
<p>To that end, we use a set of graphic directives that makes the plot
transparent. It will be appplied to plots 2 and 3 (it hides the grid (if
any) and set the background of the whole plot and of the panel to
transparent). This operation is made with the function
<code>makeTransparent()</code>.</p>
<p>It is also necessary that all plots have the same range, so that they
align correctly when superimpose. To do so, we set the vertical range
from 0 to 200. We also add a description in the title of the plot. These
are all grouped in a list:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>ornate <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span><span class="fu">paste</span>(<span class="st">&quot;(tick)     95% reference intervals (RI)&quot;</span>,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                        <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(red)      90% confidence intervals of upper 95% RI&quot;</span>,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                        <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(purple) 90% confidence intervals of lower 95% RI&quot;</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>                        <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(blue)    95% confidence intervals of the mean&quot;</span>)),</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>        <span class="fu">coord_cartesian</span>( <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">000</span>,<span class="dv">200</span>) ),</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>        <span class="fu">theme_light</span>(<span class="at">base_size=</span><span class="dv">10</span>) <span class="co"># smaller font</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>)</span></code></pre></div>
<p>Now that these are dealt with, let’s do our three plots:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>plt1 <span class="ot">&lt;-</span> <span class="fu">superbPlot</span>(glucoselevels, </span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>            <span class="at">BSFactors =</span> <span class="st">&quot;concentration&quot;</span>,  </span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>            <span class="at">variables =</span> <span class="st">&quot;gl&quot;</span>, </span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>            <span class="at">statistic =</span> <span class="st">&quot;mean&quot;</span>, </span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>            <span class="at">errorbar  =</span> <span class="st">&quot;RI&quot;</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>            <span class="at">gamma     =</span> <span class="fl">0.95</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>            <span class="at">errorbarParams =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.0</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>                                  <span class="at">position =</span> <span class="fu">position_nudge</span>( <span class="fl">0.0</span>) ),</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>            <span class="at">plotStyle =</span> <span class="st">&quot;line&quot;</span> ) <span class="sc">+</span> ornate</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>plt2 <span class="ot">&lt;-</span> <span class="fu">superbPlot</span>(glucoselevels, </span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>            <span class="at">BSFactors =</span> <span class="st">&quot;concentration&quot;</span>,  </span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>            <span class="at">variables =</span> <span class="st">&quot;gl&quot;</span>, </span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>            <span class="at">statistic =</span> <span class="st">&quot;mean&quot;</span>, </span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>            <span class="at">errorbar  =</span> <span class="st">&quot;cihiRI&quot;</span>,</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>            <span class="at">gamma     =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.90</span>),</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>            <span class="at">errorbarParams =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>                                  <span class="at">direction =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>                                  <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.15</span>) ),</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>            <span class="at">plotStyle =</span> <span class="st">&quot;line&quot;</span> ) <span class="sc">+</span> ornate <span class="sc">+</span> <span class="fu">makeTransparent</span>()</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>plt3 <span class="ot">&lt;-</span> <span class="fu">superbPlot</span>(glucoselevels, </span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>            <span class="at">BSFactors =</span> <span class="st">&quot;concentration&quot;</span>,  </span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>            <span class="at">variables =</span> <span class="st">&quot;gl&quot;</span>, </span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>            <span class="at">statistic =</span> <span class="st">&quot;mean&quot;</span>, </span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>            <span class="at">errorbar  =</span> <span class="st">&quot;ciloRI&quot;</span>,</span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>            <span class="at">gamma     =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.90</span>),</span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>            <span class="at">errorbarParams =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">&quot;purple&quot;</span>,</span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>                                  <span class="at">direction =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>                                  <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.15</span>) ),</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>            <span class="at">plotStyle =</span> <span class="st">&quot;line&quot;</span> ) <span class="sc">+</span> ornate <span class="sc">+</span> <span class="fu">makeTransparent</span>()</span></code></pre></div>
<p>Things to note: (1) only the second and third uses the transparent
directives; (2) the confidence levels (<code>gamma</code>) have two
numbers in plots 2 and 3: the first for the RI, the second for the CI of
the RI; (3) with <code>errorbarParams</code>, we gave different
attributes to the various error bars (purple color for the lower CI, for
example) and moved them sligtly to the left (position).</p>
<p>Almost there. Lets turn these plots into graphic objects
(<code>grob</code>), then superimpose them onto an empty plot:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># transform the three plots into visual objects</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>plt1 <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(plt1)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>plt2 <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(plt2)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>plt3 <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(plt3)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co"># superimpose the grobs onto an empty ggplot </span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>    <span class="fu">annotation_custom</span>(<span class="at">grob=</span>plt1) <span class="sc">+</span> </span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>    <span class="fu">annotation_custom</span>(<span class="at">grob=</span>plt2) <span class="sc">+</span> </span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>    <span class="fu">annotation_custom</span>(<span class="at">grob=</span>plt3)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Figure 3a. Mean glucose level and 95% reference intervals with 95% confidence intervals." />
<div class="figcaption"><strong>Figure 3a</strong>. Mean glucose level
and 95% reference intervals with 95% confidence intervals.</div>
</div>
</div>
<div id="is-that-it" class="section level2">
<h2>Is that it?</h2>
<p>Well, we are just begining! The whole point of the reference
intervals is to provide an indication of the individuals in the
population. It would be great if we could see these, don’t you
think?</p>
<p>There are multiple ways to illustrate the individuals from a sample.
One is using jittered dots: each member of the sample is illustrated
with a small dot whose horizontal position can be jittered randomly to
avoid that many dots superimposes and no longer be visible.</p>
<p>These is a layout in <code>superb</code> that achieve exacly that,
<code>pointjitter</code>. You can for example redo plot 1 but changing
the layout, then superimpose the plots again, as in</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># redo plt1; the other 2 are still in memory</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>plt1 <span class="ot">&lt;-</span> <span class="fu">superbPlot</span>(glucoselevels, </span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>            <span class="at">BSFactors =</span> <span class="st">&quot;concentration&quot;</span>,  </span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>            <span class="at">variables =</span> <span class="st">&quot;gl&quot;</span>, </span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>            <span class="at">statistic =</span> <span class="st">&quot;mean&quot;</span>, </span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>            <span class="at">errorbar  =</span> <span class="st">&quot;RI&quot;</span>,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>            <span class="at">gamma     =</span> <span class="fl">0.95</span>,</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>            <span class="at">errorbarParams =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.0</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>                                  <span class="at">position =</span> <span class="fu">position_nudge</span>( <span class="fl">0.0</span>) ),</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>            <span class="at">plotStyle =</span> <span class="st">&quot;pointjitter&quot;</span> ) <span class="sc">+</span> ornate</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co"># transform the new plot into a visual object</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>plt1 <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(plt1)</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co"># superimpose the grobs onto an empty ggplot </span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>    <span class="fu">annotation_custom</span>(<span class="at">grob=</span>plt1) <span class="sc">+</span> </span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>    <span class="fu">annotation_custom</span>(<span class="at">grob=</span>plt2) <span class="sc">+</span> </span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>    <span class="fu">annotation_custom</span>(<span class="at">grob=</span>plt3)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Figure 3b. Jittered dots showing mean glucose level and 95% reference intervals with 95% confidence intervals." />
<div class="figcaption"><strong>Figure 3b</strong>. Jittered dots
showing mean glucose level and 95% reference intervals with 95%
confidence intervals.</div>
</div>
<p>As seen, it is now easy to see the individuals from the sample and
that most of them are indeed within the reference intervals.</p>
<p>A more elaborate layout, although maybe redundant with the RI, is the
<code>pointjitterviolin</code> as done in the next example.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># redo plt1; the other 2 are still in memory</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>plt1 <span class="ot">&lt;-</span> <span class="fu">superbPlot</span>(glucoselevels, </span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>            <span class="at">BSFactors =</span> <span class="st">&quot;concentration&quot;</span>,  </span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>            <span class="at">variables =</span> <span class="st">&quot;gl&quot;</span>, </span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>            <span class="at">statistic =</span> <span class="st">&quot;mean&quot;</span>, </span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>            <span class="at">errorbar  =</span> <span class="st">&quot;RI&quot;</span>,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>            <span class="at">gamma     =</span> <span class="fl">0.95</span>,</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>            <span class="at">errorbarParams =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.0</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>                                  <span class="at">position =</span> <span class="fu">position_nudge</span>( <span class="fl">0.0</span>) ),</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>            <span class="at">plotStyle =</span> <span class="st">&quot;pointjitterviolin&quot;</span> ) <span class="sc">+</span> ornate</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co"># transform the three plots into visual objects</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>plt1 <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(plt1)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co"># you may superimpose the grobs onto an empty ggplot </span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#ggplot() + </span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#    annotation_custom(grob=plt1) + </span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#    annotation_custom(grob=plt2) + </span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#    annotation_custom(grob=plt3)</span></span></code></pre></div>
</div>
<div id="reference-intervals-vs.-confidence-intervals-of-the-means" class="section level2">
<h2>Reference intervals vs. confidence intervals of the means</h2>
<p>As one last example, we want to show the difference between the
reference intervals and the confidence intervals of a summary statistic,
here the mean.</p>
<p>To that end, we can create a fourth plot showing the confidence
interval of the means with</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>plt4 <span class="ot">&lt;-</span> <span class="fu">superbPlot</span>(glucoselevels, </span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>            <span class="at">BSFactors =</span> <span class="st">&quot;concentration&quot;</span>,  </span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>            <span class="at">variables =</span> <span class="st">&quot;gl&quot;</span>, </span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>            <span class="at">statistic =</span> <span class="st">&quot;mean&quot;</span>, </span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>            <span class="at">errorbar  =</span> <span class="st">&quot;CI&quot;</span>,  <span class="co"># just the regular CI of the mean</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>            <span class="at">errorbarParams =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>                                  <span class="at">position =</span> <span class="fu">position_nudge</span>( <span class="fl">0.00</span>) ),</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>            <span class="at">gamma     =</span> <span class="fl">0.95</span>,</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>            <span class="at">plotStyle =</span> <span class="st">&quot;line&quot;</span> ) <span class="sc">+</span> ornate <span class="sc">+</span> <span class="fu">makeTransparent</span>()</span></code></pre></div>
<p>This plot also has transparent theme as it will superimposed on the
previous three plots:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># transform that plot too into visual objects</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>plt4 <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(plt4)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co"># superimpose the grobs onto an empty ggplot </span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>    <span class="fu">annotation_custom</span>(<span class="at">grob=</span>plt1) <span class="sc">+</span> </span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>    <span class="fu">annotation_custom</span>(<span class="at">grob=</span>plt2) <span class="sc">+</span> </span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>    <span class="fu">annotation_custom</span>(<span class="at">grob=</span>plt3) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>    <span class="fu">annotation_custom</span>(<span class="at">grob=</span>plt4)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAEgCAMAAACKBVRjAAACKFBMVEUAAAAAAP8BAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMlJSUmJiYnJycoKCgpKSkqKiosLCwtLS0uLi4wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg6Ojo7Ozs8PDw9PT0+Pj5AQEBBQUFCQkJDQ0NFRUVGRkZISEhJSUlLS0tNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBiYmJjY2NlZWVmZmZnZ2doaGhqampra2tsbGxubm5wcHBxcXFycnJzc3N0dHR1dXV2dnZ4eHh5eXl6enp8fHx/f3+BgYGCgoKDg4OEhISFhYWGhoaIiIiJiYmKioqNjY2Ojo6Pj4+QkJCSkpKTk5OVlZWWlpaXl5eYmJiZmZmampqbm5udnZ2fn5+gIPCgoKCioqKjo6OlpaWmpqapqamrq6usrKyurq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra4uLi7u7u+vr7BwcHExMTFxcXHx8fIyMjLy8vMzMzPz8/R0dHT09PV1dXX19fZ2dnb29vd3d3e3t7h4eHk5OTl5eXm5ubn5+fo6Ojr6+vv7+/z8/P39/f7+/v/AAD////xrCuvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO1dj5/cxHWfrO+MwWDDEs4pd0nInkO5bQjZLNAYqCDh1jYo/ErZOlAESdM0hxtQWojjJltCG3qJatykdQMHhtjr2HUcExv/Yv69vje/NKPVr5F2T/dD7/O5vV1Jb+bNfGfevJmvRiK0lkqFVG3AZpcagIqlBqBiqQGoWGoAKpYagIqlBqBiqQGoWGoAKpYagIqlBqBiqQGoWAoDcDM5x/SbWlr8+03kfEmjQnmTkNsLKep2FbteFFCTcRYszLig3iJ5hX5uayQtXojLZFuC0tmbCCH3wJctBAUu20XIdjzzDDkWq3EzOXq5oIWaRA2NkREAsIDcTLL1Dfi9k6QUrIQUBOAauZ7SrfEA0G+Sg/Fa06R/4nPkG5Q2rucHvk9+8AvyMKUfkb+I17h+LC4yamiMRAFgBdyCuV98qUFOMgCSC1ZCChbwa+QXtAGN47to+MUd8G03L8TjpAX1G1/g98gCfE414Mod/Mhu+D51C3TuLaFBs1vIics3Q4qzlGVxm/xhnqJkDvrTlqNh9uoMS6YZXsEMNVJpsPy2NOibU3D0c+L6J/HC+8MCcgAoPUDu5QAkFayMFATgOmkOGn49eelclzyE318nO+FEk1yLU3qe9OHzdnKFktv4EQZAk75EgtAg8qVz17aTh07fixWDPUD9ME/B6HDyZXQKMnt1hiXT1K5AQ41U5rBNnyBzgMEvz7XI19j1Z8hNJ8+2yNGwgAKAJ8kjAoCEgpWRggAwbygAOEXuEAeb7xHWRHrkh3FKx1gPuIm8TckUNLabztJXyMGfkccvYftVKQMmJ8kM5ZUPf+EP8xT+oluJyj48w20Jr0BDTb23yd2UtslvwsLA9a+QpyIF5C7oBUIuCQASClZGigKALlMA8Cx5Vhy8udG4hF9eIb1YrSly4EyXkDevNra+fuYhMk3pLAFv1GzQuwiZ5qMtuQF9LaZ4NzRTqLHwh3mKjd7bico+PCMNlFegoWYqtDHFfSET/AHXXyHk0y/JFs4KKAbhG1aoACCpYCWkKABzVAHgkJfFQRAWqL2NTjNGTl5HyNQXyHH+a468x/6/TN58hzy6IroB+rAHecHJjxCA8Id5ijk7qF6ZfXiGJdOk6go0NKJ3B/noDLkLogAcAwgHgL6zHb4vaAVkPeBWgkEQByCpYCVkDD3gedUDGt9lzSu9oczILB8h38N/V8AxL6Kr5wMc1s9T5DlxDQAQ/jBPyeqV2YdnpIE6ABG9d8hffQV6wzGy5eCZy6IHoBzcSrywgAyA84SN2GutB2hjwEk5V4Lvd5Gv02RXuYCVQK6jlwN0NzPkDB7c1bgWBeAUa38o1xPth3lKVq/MPjwjbDEAiOjRxrbpKWwD36X0fRICQC9hv5AF5IPwPeRBuubGAB4kNM5fRMNvIP2TD0Ekj9+n0K80ydVYrSny+qkd5BB9g2w7cvYBPgV7nbxO6QrpHSNf5AbxWnv03E+npmUUJH6Yp1T1yuzVGZaMDgAaaurR3QS9ySFy29nvbEHHCdc/SPadP/t58ppWQF47DZwTiygovmAlpCAAf4lhskPIw1jQj7bzEBu/v4fNqTEdr3VimpDGS/DlGRzeZq/At2uNz+CZBUKuu8INwvq5gkH71rc5AOqHeUpVr8xenWHJ6ACgoaYePU7IRxTHIdJ49gFC8Pqrt8IVjYe1AgoAPHKznAckFKyEFATgKnf28fIk+UGxVNeQxBZwEgUrOtX/hog2YuRy47qCia4liSngRApWdjU0RiayaLj6ssZXQ2sZk9QAVCxjdkEQtUzSAyE/oxaOLZaqy9MzmgF2SWVmVVAP+YoYuT6LtlCczLVPw5fP02xORheDnynKFRShZ2INyCupPFQZQiZGrs+iLRQn0yT7T/0V2Z3NyUSTj/9hIQXomXJ5pvJQJQiZCEFyBPC9cVsGbaE4mYusK8MsKYaTkQzLRzfC/x2XTWblNqwcldcq0TPSEmYAS3AX5bNlsgsXGN/Tvpj8Ec3iocosRZgESYO8/P5OkkFbKE7mBVyFoQ+QIIaTkQzLVrL/zCL2VY174ZWj8lolekZZougGBQC549QBXFhXX0z+iGbxUGUW4wyCJGAOnWQsWSlOpkvegS/fIc+McjKSYVlh1XczuRgyKwIAldcq0TOhJaMAYKq3kLPqS8QkmsVDlVmONgiSR8nzFN0dTV+0lZzMAiNOfkgeHeVkJMPSIwcoLsocDJkVAYDKa5XomdCSUQAw1fvJa+pLJGm9zLE8VBlCxiBI7mNh0bYs2kJyMveyHuCJ6jI4Gcmw3M860iJ0YLWqJgBQea0SPRNaMgoAtsRHyXPqSyRpvcz8V5SHKghAk0YIkq8zJiOzBzCZIeD/cFX0Xh56mpyMZFj2Md+JlR0FQOW1SvRMaIkBABaW3EQRoNfVl0jSepm5RHioUmOATpC8ic33atYYEHIyzFVu49mbnIxkWI6zWGIHuTwCgMprleiZ0BIFwA4MxaWjvxkJBfElmjTN4KFKRUEGQdIgPzq+g2TRFpKToZ+BecB95Kt4LMrJSIZlG3n67EO4Fh8FIMxrlegZZYkEYIr8jBsAk8mTB6Bywy+RpGkWD1UMAMZXmATJGzDCb9+RRVsoTgZng7x9jXAykmG5iNH3p6/FAKDyWiV6RlkiAfgpGNBEjobsBAc/fV77EkmaZvBQEyBkNgIfk1vUnNl2uUklUDDjZEJmY/AxeaUyAJIJmQ3Cx+SU6gCoZTxSA1Cx1ABULBMg5cO0Nbc4rpFhzXBiRX3+SEYF9RIYMTNtzcaQJ9sgnJgFAKvJiBli2Kh4sg3CiVkAMDlGLGSDqFgbRBIoPNzUiSnBk20YTqwZHiRg/RFcQ8KaWFVGTLJBCgAkgcLDTY0fkjzZhuHEmuHBaSjBXQTK9zKUaZUZMc4GKQAaxuGmTkyJNdINw4k1w4N3QUAyPUW+R2fJtVVlxBQbpAC4wTjc1IkpyRJsFE6sGR78JRSN3AUudct0NGG9xONnxBQbpADYaRxu6sSU5Mk2CifWNMx7mbx1w5Yr5M5ownqJ+a9xMmKKDUIAphUA6nBTJ6YMnmwDcGJN7eC2xu0EivIUeSuasF5iLuNkxBQbpPihncbhpk5MSZ5so3BiTe3gfaRxHQwJU2RkD5VR4rEzYpIECvmhnfphHgVJYkryZBuEE8ME1cEPCY7ihHn9VWXEBAmk8UNUO4w2hsSU5Mk2CCeGCaqDUPdsPxXEr6vJiCVMBuMPbyqezELKMGI2AGwunsxCyqyG2gCwuXgyC6n5gIqlBqBiGYsLWjWns2boGHbRzoSL7LIqqIeETDoA8VuV7B8bp8uaoWMwjUoBYIRMxi0ZsVuV7B8bp8uaoWO2Vg0AJ2R2bguZF7UgN0LB6JLrsXFrn47hj8vbiQkei2Y1C5Vy43uQ0p9rZ8KUpZ0lARBLEbd/+LxcOFEAjFAwuuR6bNw6oGPYk3rI7Se+gwmaWZH2afCqzunt5Hh4JkxZWlESgAghowEwSsHokuexceuBjmEAiAQjWW3BpaHrcLm5b57hKUsrVE1a1rxUY8vRN1Jcdv+BAUAMBaNLjsfGrQc6hgEgEoxkhUdxRfSX5BHzDE9ZWlEWAEXI9JCP0ACIoWB0yfHYuPVAxzS2hglGsmLrkbsRgIfDM2HK0oqyAChC5mvYQiUABkOSvFUp/bFx64GO0QGIZKUBoM5oKY8LAJOQaVJFysRQMLrkeGzceqBjdAAiWWkAqDNaymMCQERBnz35grz/RJEyoxSMLnkeG7cO6Bj2uDyZoJmVBoA6o6U8JgA4ITODDv1DXj5FyoxSMLrkeWzcOqBj2OPyZIJmVjoA6kyY8pgASH1mnJCagskjZQiZdKkpmFxSZjU0/YKagsklNR9QsdQAVCw1ABVLDUDFUgNQsdQAVCzFAPjfWkrIOADIcc0fC6W8CZRrACpWtgLg6V7vsav0QK/3BBWfMWmUMGYzKtsA8M+9d0/u/fsjvV+933uFf8alUcKYzahs1QMuUfrYiwe+SemzLv+MS6OEMZtR2XIM+Hnv/JPfpvQf9vHPuDRKGLMZle0AeLX3a4pV//19/JPyGPSPtRQWKwAO9k7C6AuO51tP8M84EONljbfD6pRtADje+z/4/HXvP3/be41/xqVRwpjNqGwDQL8H4tLner2nqfiMSaOEMZtRuZ6IVaxcA1Cxcg1AqnQmnnMNQKrUAFSsXANQsXINAJPJV0N1OdcAVJxzDUDFOdcAVJxzDUDFOdcAVJxzDUDFOa8PAMrUwxrPeSwATJo16nQmnUN1Odc9YHI559KtAUjN+EINAMrk22GSbg0Ak9UFIAjUo1pqALisKgDBcDiUCGx6AERjrAGwSSNeCgEg6qJTJQDFs85n9roAoFw7tEZAHwNKjOH5zK4BSFXd5ACIxlgdAHSzA8ClFABllDvBICis3ck3gGwGAIpqd1rDlWGrsHa+7mMFwM97eyl9F+8Q/RfbLUqVzUct3fgnXLhqAAAU7gKTAGDfiwDAW+zRb7ZblKoCoJgbNwAolnmH5Zyta+eCfryX/1Fqu0VpLABoAWJuXVYNtooMAKg9GAPsTA8zAq2+500CgIPggfZ/bLtFqcxcSgKgT5HyqiIAtOX7vpUiBwD+LlAr00MLg1bgDYJgJlPFHoC3nv7gg96ztluUyjAbAAD7f/jYsWOHbVVRZlqHD3/LRu0T+Gu1Bhe4YO6HD+fJWVl4+NjCyp7BYDCTqWIPAMrzj9luUaqqBzAv4rWCwLNRgx7QWhgOCX+tEfqiXFmHI3gwXBg6E+oBL+7//e/2ftt2i9I4AMg/BqgL+TgazNq5oOCTgLaGCgAK7iQn9pixBCAY+xhwhG1R+ng/fFyx3aJkB4AeDBZYkVHtFZsuAAA1mL/+obMMPxkGGgDBwoLv5+98zGwYA3AAGfcgnCeNeCnSA8YHgIU66Pr+J8MWAiEBgObs5YdQxLB0TQHQKbKkXBAA0X3QG4CaZSTJdYf+DGgFIQALFh5MAMCU1w4AxadDRdYkofI/wV6gIkkLVdDzvFlw4QoASG7GwoetRQCKresKALAk9v2nKABsHA0gBAKnIwFgv+1cUEcAkJnzxAAwxtFOPn8YTYLr5mxKUeWiAKBAheOwqwGw4HtWg3CHcuXqANCMoa1WcKHAOGwAYK3MxwBRDZbaHR54hgAMZwM/uw+Eba6TO+fVAAA78IDat0O9L8uS5J4KfEK1arDNusPHAgUADWYs4lBuLCoH2QisBgAtCUDuatCaUkt6YqadfzLMAKBUV84vLCttDOBlyA1AB+cdAoCsrCcJAMYizBzWlNAjdGwXNEFXtcNOJx8AKgrthABw5bx5yzrTALCYy3U6zEpe5iCrE0wQADSD1QOP57DmOpbLOawsvBp4hebWhwsXWlQ5Aj4ny5s3qzDRA2S95wZAWsmU5X01yZdPGgCoh4BXAzOlZQUAK4vPAGBFsehBcvKkALAAXzk7YTbm6fmzuZTZhNODEEoHIO0WoQmHoR6vhxAAC1fKjRYLAgCE71m48mB21lcAcNRy583zFQD4voNTMz9ozeZQ5tj5rutxAAQREQSJ1PKExwAIoIeBrAY8BhFpzlRlZfOhMPCDwM8RVEhp8QVQox3mzLtjABAELogD2WcDIIyDKVzgMGUPAQj4WmqC5ROOgjrcdYYBdXJTiCiG9nJlz3X9HEGFVJ/xXegxwVAHIJ+uMFmOAb7bbft+F2pyJktbJo8AtJnnxJr3hkO+lhqfewYAR0ZewBmXRhLb0+kITgmNQX5psLS0NMhDjqHmYMBUBqh84UJ/0O/v4QRVtn6ntbRncc/SYLCCyv2lxaV+XtU/tlZWVgah2UuD/p17+kt9MCZdWRZ2MNizCMLM7kNa8Lf45cWlQUL2GQBkvRomBkQlkUaMzQrbhpfjrlUcbT3WbKATiyjI9cARs0E4h3rgO8xtcDfedVzh/bP7QEeLE1DZ8SHjwBeRVKrJTGCw8rquI2OHAKz2Pcdzk7pgBgCzOw+dOn36dLrNsQB09MjbBCA1KqAy4Pc98DmeGM2oGAS4N8lAEOHzPZ/hxXL2fAlA5pS4owdLwov4jpcFX3jGA3flwRAgo2dUd4NAMnIjSWT1AC7pRscBYM5bZRoQFbheljsWquDDgzY0Y0mLYGznOa4/zBoJ2DnP7boeDQFQa2kZCIhWE6ihC9twoDYqpGVJeQkD6Hte2/NE/DX03bYGwIjlGQC88fZRlHSjRwCQLdQAgJVBOBb9ovjCsB7ggu9wXKkMVcEdS1w5RvRZAChckA9aw1xOSIa+/HI1A3EQ/CCZ2QkPY4XPg8vxxSQCO6LnOk64lmoHAH3llq30mTSTR9LQapZNSOCfg8bwthtot+jEQiAPYSVA2+l2PV4SpuxCVTpSOd4YA3sRBSF0WINe1sKAAj/wFR+AVdqFYDQlktEOYh9vu24gAQicbhv8qD4HNJPIAOCrZJqo940niZGGVqts8gQRWXsejYHWHISjwMjFMWUJsP7blKOHKQX4z1O6cbaoUJBhH0hP7DNdvqSc5v2k3dhOhBuH4cRpewKAWOWOAYALAy78ubIHwADsOQYARhJZY8A34dirFmOAYQyLgv1bb9zJ6rDrOIHRA0at0Z0ptFYHp0CUo+e5UAY5GYhTNY7xibPi1fGnMxQAJCPARx+cNwHOajnagZFn3pV1mNJpRcZQxHa368gxwHVgVDZWQawAOAfHzuQHwEibA9C9ddccGtO+1cGhMLogY9aG2Xs8x2k7Hgegy1qgsRQ0WhcqMZaNWtJHd+Y7sgckIqACB3RVUhlMADcy7weJGwaNNudhLr4b8KFLuTNP59OMJLIA+Bwc292IHjYlTCNiHHO+8+1du9CY+TZUpiqHXoC4ryzqxLbXZZ6467mjjEhiVYjJP4IoFwRgFAZAg6RYJExPDB5MxFrQvON6KR3P7POYC1zd7orgDWwZua3LAoBnWBTaj7E2Lo0R27BBdOe6zJj5LgxO3Zj1lGQAPOZQWTt0vRjkOvG/mcPBFUwxiei22+5IHSR1H9l3PqWJ6wV+ggehUQBYsKArUxWMxKaQFQW9156798TIUVNCACInAvD7/tBxRBQ077pe3C2anZhvFGN3GIQFAFCho7dGJY0fbMiFXo/wMehdt+2kuz6qdx/mf/Q6ZANKoqYBAPh/6AImAAGbUMZrZAFwB35c2hU9bEpiDwAH4nRlQA0V4okZeaQAsQDgVArC5y6f0eAEzk13QcZkCHPq6tUw6vpS6hEr0lD2HC957OkYzQbnwe0IAEPT+PxjwKFD5BDIvtyDcMS0NgRwt0pnSgM5jY2I7oL0smAIjY2Zu3E1BYtVjGDnYyToGHUYk28n+VfgGcp+YPigtC4AgYbXzQBAV04FYItYiZBvg2d7xNJeYxXtAdCG5x0RULMBKqsedABgAmmUxI12H0MxUn8YQ2UAkAwgZXM+QlCRCDLC9RJHgREAXD9UxvbnpQwiWVHQZZCr8hfbI5b6GivTtKDrzBnt8FMxCCSEoYHXddoGAJ4TUUxATug7hhfxHWc075gEiC6iDouJUOaUgD6IWE3Eri7euRtE/sT9AamvsYo0ROgCRjV8CtuCWQ/RkVRoQncB9+8adZjWAaKGYxo4BItqgEDAF6FkerUxRRyGzb7Xbne1OkyOg0QQa5jtuk7yPCwLgGlCGiDyJwKQ/horcygbwkBqAOA6bjQaiS0Lu0ncd+dSvEhiB8hoxAlJqK8eM9Gowy76dX1FM1JL+urLCAAYieu9r2MFAHnV+CkBSH6NlSLBkBtaWVlaWjQAWNyzqPgmtf/KJJZC1aXB5/uLqg4HkiPjTFWyoPbSYHGpr2f8Z4v9PUt6xtHcpd39QX/xy0uDga68Z7E/uHNxcWmQbjS3e2UwWDGK3N+zZ1HLOqKcBcDxEQAyXmPVMfsjDqWqDmFUjUxoO3GuN96ZRhpxwhKGyBjno4bzw6Xt1PFHfoXgy4NJBzW8SBvXEsJVxJTVCH4Li6GMjjic/1jyAQ9s+8lpjRFDALJeY6UjgGL0gDTXO1K6aDQeJC/qRgDwXScCQOxG1TgX5MHQ0fX5wjla5gluwFhHH01J++7hJNBlymxF1puDqMiJuxLFhhE7ku81VpFhwAAgazXHPGaiF8h1MnZVOgA+djWjB3Td0Ul4bBzriWFK8QF8Ic14jtNoSmoWjjFne35ev63OQ4leKCUDgDcLMGLmirQZBQ2NGWn8khhfkuGX6boY1yhmK2UaG65oUq/NqmHoOnOj87jEiQDPO+BL+qrig9SVvDB4AD8L8bPrhw03tfNMgBEzJyZdE4AUbkg/Kott9gBtSpmyIiYWJflNAKwOfa/bdkbmcekzMdkDAnMhKMlsHYD5Njgd7d524xlcUcWxM2LUXNbyujg1RGPYLUoGAPH1bwDAjGKeGBVxOcKLv0Mk0gUk9cxyhuqf3zU/2gMS1iLY3BWqn48BBqOebLc4hivf811cA+OkfNJ1oYybEdNy4Qu7ruO44g4BfpdMbgA87Z4W3qpdz293nVjd6EqCWJFmyr7T3dVtj44ByVMQrHTHZy7IdaMrWMn9Flciuu225zhdcWdvCvchZMyMmJ4NA8Bz2u226o7melAKAJJTYTYoAHyYkSb0gJFhGHKWt8h2AwdpwfiMtJ/KbAQAKp7TGH6UiksDAO+AgD7v+mMDwI4RM7JhAEAtdOd8DYDEOXn0cPSmIoTEbc85bgIARvAVOH4X6QRWDd02hoVe9Nb2BAwFAOBEGI3h+ZKgTL+xiPOZLow1OI0YKgDCu4yiRnIZKyMWKRp6UnSH80EZAOSdcWxAgfrnEV1qKI5DIcSdXQiamBeZd9iNPcPYOeDIEZx0eV7b52MA91yh4cmMPuUAdPHGmUDcmCV4caU8qjZWRky3hfLwq42cjK8GpAxSXTscSApMBNTovBwYTucSekBkBufNz+9yBCOGt/VExv+EWFIMP3gvIsDghF4kJBWT6l/cUMmcJGOBudlGxnF5ZgFwCf7OJeUZm0ZoJM4/HHe+7fLbC9LY+JHD4WjB9zd5eHcBi/CS75PV7onAoXMe/to8Z28EgOQ7rMQ6BlS5G7Yb8EpOYr6hMut6eEuRr+6M01ej45QzAGBkGHk0OdfRNKgqnYM9APlQzglH72pIvLcNPwJ5F0+gAQB12nXioyAzRRh1fVz8CQSfGXHFyXf3dhQAQfiwDs2a9JuK5U1FCIDPAeD7m/jtTLG6WYMwUgFt65tzlTNFalwY40tr5LQ8zZmqIos9YuB+cIUACW8vTVlNQVy8q9Tj8wDfnH+n3lzdYTwC3pEhdppS3ZpcN5ayIVjOfdhyWBtdWoJyFgDn4eNEQQDYFBx7r7hNz3dcFp3zOkwdzdRcCpqiaMTs5kQ5qU+5uU2oO130I3yjUGQZL70WWd4Yw/raPmFuTbqmOQOV21QxpsK7E70E5SwAvgIfX7C/PV0OpAFnyJkx/CbxtgIgTzEkAKFDyhgKFQT8xqJhGIskR4KjuQceEmChC+LWZKmaievzR+iNSVuzMgB4hJAGgelwqsRsUdJ4mcHS0iIac2GwsrjUH9w5GAz66buFBCfD2Zc9THllqb+4NJCETMZWow7Lvb+0tNJnW5QkT4K7jLI3KYHyYGVpD9ja58qKScm5tUqYrnJeWhz0F2eSlLOioJUvzd3zYXr9J2/QYOLJHc/sRimYpngezR7NJLkntigF7fku3ijnpo4AWu4dMXNQs7hAbt3OFNwkw3cV6T0gO1OhLCM44YL4ylLy1sSJ7ZLU7lMTMxrwqo5cCsoezfi97eh6mBvHqNDBD6adbZMcCsQqFH5dyPvcqxa7l9cLTABy1T/LmA/ZfNzL3J45uW2q4Z2afFLCYjsxocnhiIUPlwCwO9UFADmbIutHIhahFvu0g6F4OFAQdh+LDc6sA5kApBV3gvuEVVQmbm7DWIDfYpZrNPP46gHfIwZhvdvmGyWzlfX8JQCd/M8vVo+Ik4sgWI254FvmwmMmHjuwfSVpFk9yozbWAG/yfFEFt+rkfeCA2K2I8DEv4iKfgotL2cqyGlg+AoDcqFFW4QuRhXD+FMucXWCZjz+s0eEkaJjq+Sa6Ux7367ImL4wZpu3ZH1HmYai6r9FiszvKMr+YjwE29c9qT9/gj3m3WqPEWJLyMs9NmO376UPPxAAQ7TAEQLRoSxciH1eTuD8lSZb55bwOreqfsgFb7ZLkU4CRe/wTBC5bDpTzQwDYAxiTZcLPilheYA1Hq0OLxihCOi0WsVBelgp2jwuU7QYfThNGQZ3oSnqSYI9flg+KvcA7k5f6uL9JA4DBgx7PWbVFHs3LgJoHR3mfm7Qs8yvwvEaoQ3w2ijK7YwsAz/EC080YPSYNANUeegX2tXJNhdQ4qvqyL5Zi8j/1SgPAbgRAM5fZs1FCAPDDi93dE9UEny9GH/nygQyTJw6AaAIXtKcH5RUtkEEAWrnbIRsK+ZdCrzAJlvkzRwUAkqDIk3MgclYAZClOHgD+mLILaMeMzaMHRSCjAGDrCHmqgfceRWAVeWbvsnwmS/gGjfw5U5ExvSCdaJVjAH5gTMcBsHtknxFJBtx55RsDwtpqBYMiAFCetfbYXcvHDfLhP4fzswfA6jVWYUnYWpjdQytjqiGnhPcTLiysFHgRlQihVCNmSVm+CGgSr7FikvM1ViPdkc1urMqgV4NlM5Y5BcMyABR75LWQib1Jr8BrrERJ7J5ZGd8OLaUUAAUHECmTepdkkddYcQBs3eiyfEpSiXYYtOzGAL3j0rX5NtUir7FCoqjTsXwN1eFlfnkndldQXunkYrImpJzjqmJRkPVrrHhTyj+N5ZGkfEBMgbmUlnPxNrwaL9K1B6DQa6yK9OVAB8BWOcy5OHYllfMZbQ9AoddY2b/Eh7OpXLkMACU6T2nlPBdNeCKmxLr+9Y0cNQA2acTLegWghG4NgNAurrqZATC2pBR/K2jaEHYAAAPZSURBVDmtEoBcr3FfswDouuWCwRK6NQDjUC6hWwMwDuUSuhsJgEIpS+XKAMhVh6WUNz4Ak6/DUsqrBUCpktQA2KQRLzUACVIDULHy+gCgjPJmAKAwZ5GX2ph0BhVK3QMqVq4BqFi5BqBi5XUBwEZWrgGoWLkGoGLlGoCKlWsAKlauAahYuQagYuUagIqVawAqVq4BqFi5MAD5tijZGbMZlYsCkLlFqYgxm1G5KABWW5TyGrMZlYsCYLdFac1XQ3XKZQDIv0WplkQp7ILstiit9XZYnXJRACy3KK31aqhOuXAYardFaa1XQ3XK9USsYuUagIqVawAqVh4LALWUkDEAkAukWjmP1ABUrDw5AGrJJTUAFUsNQMUyMQA+7H2rqOoH7C3G1wpqn38ctF8snvPeJ7Je4pWi3Os9Zqk1MQD++vFeUdUPevTau70fF9Teu++/Pv6n3r8VzfnSv+/dVyzjDwoVeGIA9P5n708KqiIA/937bTHlf+1dLpgtFXX4p95Piytby6QAeG0vPbC/oC7ry08VVH6xaK48Z/zc97cFlVH+zlJrUgDs/xv6u96fiuliNRzfm/E+0SR5qaADUTmDE8v12oAEZVuZEAB/YK3hpWLKrCTf21tM+Re988UUVc5/6P1HcWVrmRAA30ZjXihYh1iS3+97IvvCWNm778iln+8tNoRDzld/tbegE1tTAPT+ET4+7r1bSJk50/1FG/KfSoahvScvlVDu2aJQT8QqlhqAiqUGoGKpAahYagAqlhqAiqUGoGLZsABsORT9+QYpsUw3MdmwAJBDaT/XjqwzAB4l7HXrj8O/WfomeZCQ6avy4DMNQr4qD8KhO94gc+TI/fBtnvKflyOKa0HWFwAr5Mtn58ml98kdZ54li2+TbccPkkVx8B0ye3Y/eUUcvAxN/m2y4+x5cs/FLvkN/gQATMWqS8NkfQFwNzf3K/hv+oaj5CdQgDvFwTY7eIs4iDV+lLzO1cgBAYCpuPr2x8j6AmCuwf59Fv/dOHWUnKa0sVscnMPXv5Gt4iAH4BS91sSjfQGAqVhdOTRZXwDcw83tsoa8XdSjOHgf/2cAcJo+QJ4+e1EBYCpWVAhT1hcAx8n8ybvJuePkC+eeIk+KehQHT5Avnn2VPC0OXiX7LuPXL5IjR3eQL+FPAMBUrLo0TNYXAHQf+JNv8ChoXjZ2ebAPUVBTHZwiu/DrKTi47wbyHPyUUVCouBZknQGw8aQGoGKpAahYagAqlhqAiqUGoGKpAahYagAqlhqAiqUGoGKpAahYagAqlhqAiqUGoGKpAahYagAqlhqAiuX/AVpurpZ8L1BhAAAAAElFTkSuQmCC" alt="Figure 3d. Jittered dots and violins showing mean glucose level +-95% confidence intervals of the mean, and 95% reference intervals with 95% confidence intervals." />
<div class="figcaption"><strong>Figure 3d</strong>. Jittered dots and
violins showing mean glucose level +-95% confidence intervals of the
mean, and 95% reference intervals with 95% confidence intervals.</div>
</div>
<p>As seen in blue, the confidence interval of the means have much
shorter intervals than the reference interval. This is ok (or should I
say, <em>normal</em>): Both intervals represent very different things.
Also, the interval widths of the CI of the mean are shorter than the
interval widths of the CI or the RI tips for two reasons: (1) the RI
tips are based on 90% confidence levels; (2) a central tendency
statistic is easier to estimate than an extreme quantile statistic.</p>
</div>
<div id="in-summary" class="section level2">
<h2>In summary</h2>
<p>Reference intervals are useful to depict the population as a whole.
It is not an error bar in the sense that it does not represent the error
for the estimation of a statistic. Instead, it is an illustration of the
individuals’ possible scores.</p>
<p>Note that Reference intervals <strong>must not</strong> be used in
conjunction with adjustments. These adjustments are used when conditions
are compared to other conditions. Reference intervals are not
comparative statistics, they show the extend of the sample, irrespective
of what the other samples might look like.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-f20" class="csl-entry">
Finnegan, D. (2020). <em>referenceIntervals: Reference intervals</em>.
Retrieved from <a href="https://CRAN.R-project.org/package=referenceIntervals">https://CRAN.R-project.org/package=referenceIntervals</a>
</div>
<div id="ref-htc14" class="csl-entry">
Harding, B., Tremblay, C., &amp; Cousineau, D. (2014). Standard errors:
A review and evaluation of standard error estimators using monte carlo
simulations. <em>The Quantitative Methods for Psychology</em>,
<em>10</em>(2), 107–123.
</div>
<div id="ref-nccls00" class="csl-entry">
NCCLS. (2000). <em>How to define and determine reference intervals in
the clinical laboratory; approved guideline - second edition.</em> (No.
NCCLS document C28-A2). 940 West Valley Road, Suite 1400, Wayne,
Pennsylvania 19087-1898, USA.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
